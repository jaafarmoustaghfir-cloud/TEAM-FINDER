<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TEAM FINDER | Official Scouting Platform</title>
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 500"><path d="M250 40 L410 110 V250 C410 360 250 460" fill="none" stroke="%23f58220" stroke-width="20" /><path d="M250 460 C250 460 90 360 90 250 V110 L250 40" fill="none" stroke="%23003B73" stroke-width="20" /><circle cx="250" cy="250" r="120" fill="white" stroke="%23003B73" stroke-width="25" /><path d="M205 280 Q220 230 205 180" fill="%23003B73" /><path d="M295 280 Q280 230 295 180" fill="%23f58220" /><path d="M230 250 L270 250" stroke="%23333" stroke-width="10" stroke-linecap="round" /><line x1="340" y1="340" x2="420" y2="420" stroke="%23333" stroke-width="40" stroke-linecap="round" /></svg>' />
    
    <!-- Dependencies -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #09090b;
            color: #fafafa;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }
        
        .hidden { display: none !important; }
        
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #09090b; }
        ::-webkit-scrollbar-thumb { background: #27272a; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #3f3f46; }

        .brand-gradient {
            background: linear-gradient(to right, #f58220, #ea580c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .animate-fade { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .glass {
            background: rgba(18, 18, 23, 0.8);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(39, 39, 42, 0.5);
        }

        .auth-card {
            background: #121217;
            border: 1px solid #27272a;
            border-radius: 2rem;
        }

        .input-dark {
            background: #09090b;
            border: 1px solid #27272a;
            color: white;
            padding: 0.75rem 1rem;
            border-radius: 0.75rem;
            width: 100%;
            outline: none;
            transition: all 0.2s;
        }
        .input-dark:focus { border-color: #f58220; box-shadow: 0 0 0 2px rgba(245, 130, 32, 0.2); }

        .btn-primary {
            background: #f58220;
            color: white;
            font-weight: 800;
            text-transform: uppercase;
            padding: 1rem 2rem;
            border-radius: 1rem;
            transition: all 0.2s;
            letter-spacing: 0.05em;
        }
        .btn-primary:hover { background: #ea580c; transform: translateY(-1px); }
        .btn-primary:active { transform: translateY(0); }

        .progress-bar {
            height: 4px;
            background: #27272a;
            border-radius: 2px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: #f58220;
            width: 0%;
            transition: width 0.1s linear;
        }
        
        .role-badge {
            font-size: 10px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            padding: 4px 12px;
            border-radius: 12px;
        }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "react-router-dom": "https://esm.sh/react-router-dom@^7.11.0",
    "lucide-react": "https://esm.sh/lucide-react@^0.562.0",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>
</head>
<body class="flex flex-col min-h-screen">

    <!-- Navbar -->
    <nav class="sticky top-0 z-50 glass border-b border-zinc-800 h-20">
        <div class="max-w-7xl mx-auto px-4 h-full flex justify-between items-center">
            <div class="flex items-center">
                <a href="#" onclick="route('home')" class="flex items-center gap-3 group">
                    <div class="h-10 w-10 sm:h-12 sm:w-12 flex items-center justify-center">
                        <!-- Updated Logo SVG to match provided image -->
                        <img src='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 500"><path d="M250 40 L410 110 V250 C410 360 250 460" fill="none" stroke="%23f58220" stroke-width="20" /><path d="M250 460 C250 460 90 360 90 250 V110 L250 40" fill="none" stroke="%23003B73" stroke-width="20" /><circle cx="250" cy="250" r="120" fill="white" stroke="%23003B73" stroke-width="25" /><path d="M205 280 Q220 230 205 180" fill="%23003B73" /><path d="M295 280 Q280 230 295 180" fill="%23f58220" /><path d="M230 250 L270 250" stroke="%23333" stroke-width="10" stroke-linecap="round" /><line x1="340" y1="340" x2="420" y2="420" stroke="%23333" stroke-width="40" stroke-linecap="round" /></svg>' class="max-h-full" />
                    </div>
                    <div class="flex flex-col">
                        <span class="text-xl font-black tracking-tighter text-[#003B73] uppercase leading-none">
                            TEAM<span class="text-[#f58220]">FINDER</span>
                        </span>
                        <span class="text-[10px] font-bold text-zinc-500 tracking-widest uppercase hidden sm:block">Find Your Squad.</span>
                    </div>
                </a>
            </div>

            <div id="nav-links" class="hidden md:flex items-center gap-8">
                <a href="#" onclick="route('home')" class="text-xs font-black uppercase tracking-widest text-zinc-400 hover:text-white transition-colors">Home</a>
                <a href="#" onclick="route('about')" class="text-xs font-black uppercase tracking-widest text-zinc-400 hover:text-white transition-colors">About</a>
                <a href="#" onclick="route('how-it-works')" class="text-xs font-black uppercase tracking-widest text-zinc-400 hover:text-white transition-colors text-nowrap">How it Works</a>
                <div class="h-4 w-px bg-zinc-800 mx-2"></div>
                <div id="auth-nav-items"></div>
            </div>
            
            <button class="md:hidden text-zinc-400" onclick="toggleMobileMenu()">
                <i data-lucide="menu"></i>
            </button>
        </div>
    </nav>

    <main id="app-root" class="flex-grow">
        <!-- Views injected by JS -->
    </main>

    <!-- Footer -->
    <footer class="bg-zinc-950 border-t border-zinc-900 py-16 mt-20">
        <div class="max-w-7xl mx-auto px-4 grid grid-cols-1 md:grid-cols-3 gap-12 text-center md:text-left">
            <div>
                <div class="flex items-center justify-center md:justify-start gap-2 mb-6">
                    <img src='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 500"><path d="M250 40 L410 110 V250 C410 360 250 460" fill="none" stroke="%23f58220" stroke-width="20" /><path d="M250 460 C250 460 90 360 90 250 V110 L250 40" fill="none" stroke="%23003B73" stroke-width="20" /><circle cx="250" cy="250" r="120" fill="white" stroke="%23003B73" stroke-width="25" /><path d="M205 280 Q220 230 205 180" fill="%23003B73" /><path d="M295 280 Q280 230 295 180" fill="%23f58220" /><path d="M230 250 L270 250" stroke="%23333" stroke-width="10" stroke-linecap="round" /><line x1="340" y1="340" x2="420" y2="420" stroke="%23333" stroke-width="40" stroke-linecap="round" /></svg>' class="h-8 w-8" />
                    <div class="text-2xl font-black tracking-tighter text-[#003B73] uppercase">TEAM<span class="text-[#f58220]">FINDER</span></div>
                </div>
                <p class="text-zinc-500 text-sm font-medium">Professional scouting registry. Private by default. Secure by design.</p>
            </div>
            <div>
                <h4 class="text-white font-black mb-6 uppercase tracking-widest text-[10px]">Registry</h4>
                <ul class="space-y-4 text-xs font-black uppercase tracking-widest text-zinc-600">
                    <li><a href="#" onclick="route('signup-player')" class="hover:text-white transition-colors">Player Application</a></li>
                    <li><a href="#" onclick="route('signup-team')" class="hover:text-white transition-colors">Club Registration</a></li>
                </ul>
            </div>
            <div>
                <h4 class="text-white font-black mb-6 uppercase tracking-widest text-[10px]">Support</h4>
                <p class="text-orange-500 text-sm font-bold">Call: 0772908456</p>
                <p class="text-zinc-600 text-[10px] font-black uppercase mt-2">Available Mon-Fri 9:00 - 18:00</p>
            </div>
        </div>
    </footer>

    <!-- Template Fragments -->
    <div id="templates" class="hidden">
        <!-- View: Home -->
        <div id="tpl-view-home">
            <section class="relative h-[85vh] flex items-center justify-center px-4">
                <div class="absolute inset-0 overflow-hidden">
                    <img src="https://images.unsplash.com/photo-1574629810360-7efbbe195018?q=80&w=2400" class="w-full h-full object-cover opacity-20 grayscale scale-110 blur-sm" />
                    <div class="absolute inset-0 bg-gradient-to-b from-zinc-950 via-transparent to-zinc-950"></div>
                </div>
                <div class="relative z-10 max-w-7xl mx-auto text-center animate-fade">
                    <div class="inline-flex items-center gap-3 px-6 py-2.5 rounded-full bg-orange-500/10 border border-orange-500/20 text-orange-500 text-[10px] font-black uppercase tracking-[0.3em] mb-12">
                        <i data-lucide="zap" class="w-4 h-4"></i> The Ultimate Scouting Registry
                    </div>
                    <h1 class="text-6xl md:text-[9rem] font-black text-white mb-10 leading-[0.85] tracking-tighter uppercase">
                        Unleash Your<br />
                        <span class="brand-gradient drop-shadow-2xl">Football Future.</span>
                    </h1>
                    <p class="text-xl md:text-2xl text-zinc-500 max-w-4xl mx-auto mb-16 font-medium">Verified private network for players and official clubs. No public listing. Real opportunities.</p>
                    <div id="hero-actions" class="flex flex-col sm:flex-row gap-6 justify-center"></div>
                </div>
            </section>
        </div>

        <!-- View: Login -->
        <div id="tpl-view-login">
            <div class="max-w-md mx-auto py-32 px-4 animate-fade">
                <div class="auth-card p-12">
                    <h2 class="text-3xl font-black text-white mb-8 uppercase tracking-tighter">Welcome Back</h2>
                    <form onsubmit="handleAuthAction(event, 'login')" class="space-y-6">
                        <div>
                            <label class="text-[10px] font-black uppercase text-zinc-500 block mb-2">Email Address</label>
                            <input id="login-email" type="email" required class="input-dark" placeholder="you@example.com">
                        </div>
                        <div>
                            <label class="text-[10px] font-black uppercase text-zinc-500 block mb-2">Password</label>
                            <input id="login-pass" type="password" required class="input-dark" placeholder="••••••••">
                        </div>
                        <button type="submit" class="btn-primary w-full">Sign In</button>
                    </form>
                    <p class="mt-8 text-center text-zinc-500 text-xs font-bold uppercase tracking-widest">No account? <a href="#" onclick="route('signup-player')" class="text-orange-500">Join Platform</a></p>
                </div>
            </div>
        </div>

        <!-- View: Player Signup -->
        <div id="tpl-view-signup-player">
            <div class="max-w-3xl mx-auto py-24 px-4 animate-fade">
                <div class="auth-card p-12">
                    <div class="flex items-center justify-between mb-10">
                        <h2 class="text-4xl font-black text-white uppercase tracking-tighter">Athlete Sign Up</h2>
                        <span class="role-badge bg-orange-600/10 text-orange-500 border border-orange-500/20">Player</span>
                    </div>
                    
                    <form onsubmit="handleAuthAction(event, 'signup-player')" class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="space-y-6 md:col-span-2">
                             <h4 class="text-[10px] font-black text-zinc-500 uppercase tracking-widest border-b border-zinc-800 pb-2">Account Credentials</h4>
                             <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="text-[10px] font-black uppercase text-zinc-500 block mb-2">Email</label>
                                    <input id="sp-email" type="email" required class="input-dark">
                                </div>
                                <div>
                                    <label class="text-[10px] font-black uppercase text-zinc-500 block mb-2">Password</label>
                                    <input id="sp-pass" type="password" required class="input-dark">
                                </div>
                             </div>
                        </div>

                        <div class="space-y-6 md:col-span-2">
                             <h4 class="text-[10px] font-black text-zinc-500 uppercase tracking-widest border-b border-zinc-800 pb-2">Personal & Technical</h4>
                             <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="text-[10px] font-black uppercase text-zinc-500 block mb-2">Full Name</label>
                                    <input id="sp-name" type="text" required class="input-dark">
                                </div>
                                <div>
                                    <label class="text-[10px] font-black uppercase text-zinc-500 block mb-2">Date of Birth</label>
                                    <input id="sp-dob" type="date" required class="input-dark">
                                </div>
                                <div>
                                    <label class="text-[10px] font-black uppercase text-zinc-500 block mb-2">Position</label>
                                    <select id="sp-pos" class="input-dark">
                                        <option value="Attacker">Attacker</option>
                                        <option value="Midfielder">Midfielder</option>
                                        <option value="Defender">Defender</option>
                                        <option value="Goalkeeper">Goalkeeper</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="text-[10px] font-black uppercase text-zinc-500 block mb-2">Location (City, Country)</label>
                                    <input id="sp-loc" type="text" required class="input-dark" placeholder="London, UK">
                                </div>
                             </div>
                        </div>

                        <div class="md:col-span-2 pt-6">
                            <button type="submit" class="btn-primary w-full">Create Athlete Account</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- View: Team Signup -->
        <div id="tpl-view-signup-team">
            <div class="max-w-3xl mx-auto py-24 px-4 animate-fade">
                <div class="auth-card p-12">
                    <div class="flex items-center justify-between mb-10">
                        <h2 class="text-4xl font-black text-white uppercase tracking-tighter">Club Registration</h2>
                        <span class="role-badge bg-blue-600/10 text-blue-500 border border-blue-500/20">Club</span>
                    </div>
                    
                    <form onsubmit="handleAuthAction(event, 'signup-team')" class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="space-y-6 md:col-span-2">
                             <h4 class="text-[10px] font-black text-zinc-500 uppercase tracking-widest border-b border-zinc-800 pb-2">Official Credentials</h4>
                             <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="text-[10px] font-black uppercase text-zinc-500 block mb-2">Club Email</label>
                                    <input id="st-email" type="email" required class="input-dark">
                                </div>
                                <div>
                                    <label class="text-[10px] font-black uppercase text-zinc-500 block mb-2">Password</label>
                                    <input id="st-pass" type="password" required class="input-dark">
                                </div>
                             </div>
                        </div>

                        <div class="space-y-6 md:col-span-2">
                             <h4 class="text-[10px] font-black text-zinc-500 uppercase tracking-widest border-b border-zinc-800 pb-2">Club Details</h4>
                             <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="text-[10px] font-black uppercase text-zinc-500 block mb-2">Club/Team Name</label>
                                    <input id="st-name" type="text" required class="input-dark">
                                </div>
                                <div>
                                    <label class="text-[10px] font-black uppercase text-zinc-500 block mb-2">Category</label>
                                    <select id="st-cat" class="input-dark">
                                        <option value="Professional">Professional</option>
                                        <option value="Semi-Pro">Semi-Pro</option>
                                        <option value="Academy">Academy</option>
                                        <option value="Amateur">Amateur</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="text-[10px] font-black uppercase text-zinc-500 block mb-2">Location (City, Country)</label>
                                    <input id="st-loc" type="text" required class="input-dark">
                                </div>
                                <div>
                                    <label class="text-[10px] font-black uppercase text-zinc-500 block mb-2">Recruiting Position</label>
                                    <input id="st-needs" type="text" required class="input-dark" placeholder="Strikers, Winger">
                                </div>
                             </div>
                        </div>

                        <div class="md:col-span-2 pt-6">
                            <button type="submit" class="btn-primary w-full bg-blue-600 hover:bg-blue-700">Submit Club Registration</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- View: Player Dashboard -->
        <div id="tpl-view-player-dashboard">
            <div class="max-w-7xl mx-auto py-12 px-4 animate-fade">
                <div class="flex flex-col lg:flex-row gap-12">
                    <div class="lg:w-1/3">
                        <div class="auth-card p-10 space-y-8 sticky top-24">
                            <div class="text-center">
                                <div class="relative w-32 h-32 rounded-[2rem] bg-zinc-800 border-4 border-zinc-950 mx-auto overflow-hidden shadow-2xl group">
                                    <img id="dash-player-photo" src="" class="w-full h-full object-cover" />
                                    <label class="absolute inset-0 bg-black/60 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer">
                                        <i data-lucide="camera" class="w-6 h-6 text-white"></i>
                                        <input type="file" class="hidden" accept="image/*" onchange="handleImageUpload(event, 'player')">
                                    </label>
                                </div>
                                <h2 id="dash-player-name" class="text-2xl font-black text-white uppercase tracking-tighter mt-6"></h2>
                                <p id="dash-player-meta" class="text-xs font-black uppercase text-zinc-500 tracking-widest mt-2"></p>
                            </div>
                            <div class="space-y-4 pt-8 border-t border-zinc-800">
                                <button onclick="logout()" class="w-full py-4 text-xs font-black uppercase text-red-500 border border-red-500/20 rounded-xl hover:bg-red-500/10 transition-colors">Sign Out</button>
                            </div>
                        </div>
                    </div>

                    <div class="flex-1 space-y-12">
                        <div class="bg-zinc-900 border border-zinc-800 rounded-[3rem] p-12 shadow-2xl">
                            <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-6 mb-10">
                                <div>
                                    <h3 class="text-3xl font-black text-white uppercase tracking-tighter">Performance Reels</h3>
                                    <p class="text-zinc-500 text-xs font-bold uppercase tracking-widest mt-1">Upload verified match footage</p>
                                </div>
                                <label class="bg-white hover:bg-zinc-200 text-zinc-950 px-8 py-4 rounded-2xl font-black uppercase text-xs tracking-widest cursor-pointer shadow-xl active:scale-95 transition-all">
                                    Upload Video
                                    <input type="file" id="video-upload-input" class="hidden" accept="video/*" onchange="handleVideoUpload(event)">
                                </label>
                            </div>

                            <div id="upload-status" class="hidden mb-10 p-6 bg-zinc-950 border border-zinc-800 rounded-2xl">
                                <div class="flex items-center justify-between mb-3">
                                    <span class="text-xs font-black text-white uppercase tracking-widest">Processing...</span>
                                    <span id="upload-percent" class="text-xs font-black text-orange-500 uppercase">0%</span>
                                </div>
                                <div class="progress-bar"><div id="upload-progress-fill" class="progress-fill"></div></div>
                            </div>

                            <div id="reels-grid" class="grid grid-cols-1 md:grid-cols-2 gap-8"></div>
                        </div>

                        <div class="bg-zinc-900 border border-zinc-800 rounded-[3rem] p-12 shadow-2xl">
                            <div class="flex items-center gap-4 mb-10">
                                <div class="w-12 h-12 bg-orange-600/20 rounded-2xl flex items-center justify-center text-orange-500 border border-orange-500/30">
                                    <i data-lucide="sparkles"></i>
                                </div>
                                <h3 class="text-3xl font-black text-white uppercase tracking-tighter">Recommended Teams</h3>
                            </div>
                            <div id="player-recs-grid" class="grid grid-cols-1 md:grid-cols-2 gap-8"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- View: Team Dashboard -->
        <div id="tpl-view-team-dashboard">
            <div class="max-w-7xl mx-auto py-12 px-4 animate-fade">
                <div class="flex flex-col lg:flex-row gap-12">
                    <div class="lg:w-1/3">
                        <div class="auth-card p-10 space-y-8 sticky top-24">
                            <div class="text-center">
                                <div class="relative w-32 h-32 rounded-[2rem] bg-zinc-800 border-4 border-zinc-950 mx-auto overflow-hidden shadow-2xl group">
                                    <img id="dash-team-logo" src="" class="w-full h-full object-cover" />
                                    <label class="absolute inset-0 bg-black/60 flex items-center justify-center opacity-0 group-hover:opacity-10 transition-opacity cursor-pointer">
                                        <i data-lucide="camera" class="w-6 h-6 text-white"></i>
                                        <input type="file" class="hidden" accept="image/*" onchange="handleImageUpload(event, 'team')">
                                    </label>
                                </div>
                                <h2 id="dash-team-name" class="text-2xl font-black text-white uppercase tracking-tighter mt-6"></h2>
                                <p id="dash-team-meta" class="text-xs font-black uppercase text-zinc-500 tracking-widest mt-2"></p>
                            </div>
                            <div class="space-y-4 pt-8 border-t border-zinc-800">
                                <button onclick="logout()" class="w-full py-4 text-xs font-black uppercase text-red-500 border border-red-500/20 rounded-xl hover:bg-red-500/10 transition-colors">Sign Out</button>
                            </div>
                        </div>
                    </div>

                    <div class="flex-1 space-y-12">
                        <div class="flex items-center justify-between">
                            <div>
                                <h1 class="text-5xl font-black text-white uppercase tracking-tighter">Scouting Registry</h1>
                                <p class="text-zinc-500 font-bold uppercase tracking-widest text-[10px] mt-2">Private Player Discovery Terminal</p>
                            </div>
                            <div class="relative">
                                <i data-lucide="search" class="absolute left-4 top-1/2 -translate-y-1/2 text-zinc-600 w-4 h-4"></i>
                                <input id="player-search" type="text" oninput="filterDashboardPlayers()" placeholder="Filter by position..." class="bg-zinc-900 border border-zinc-800 rounded-xl py-3 pl-12 pr-6 text-white text-xs outline-none focus:border-blue-500 w-64">
                            </div>
                        </div>
                        <div id="player-registry" class="grid grid-cols-1 md:grid-cols-2 gap-10"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- DATA & ACCOUNTS ---
        const STORAGE_KEY = 'tf_app_data_v2';
        const loadState = () => {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) return JSON.parse(saved);
            return {
                users: [
                    { id: 'u1', name: 'Marco Rossi', email: 'marco@test.com', pass: 'hash_123', role: 'player', pos: 'Attacker', loc: 'Milan, Italy', dob: '2005-01-01', video: null, photo: 'https://images.unsplash.com/photo-1543353071-10c8ba85a904?w=400&fit=crop' },
                    { id: 'u2', name: 'London Blues', email: 'club@test.com', pass: 'hash_123', role: 'team', cat: 'Professional', loc: 'London, UK', needs: 'Attacker, Winger', logo: 'https://images.unsplash.com/photo-1508098682722-e99c43a406b2?w=400&fit=crop' }
                ],
                currentUser: null,
                currentView: 'home'
            };
        };

        let state = loadState();
        const saveState = () => localStorage.setItem(STORAGE_KEY, JSON.stringify(state));

        // --- AUTH ACTIONS ---
        const simpleHash = (str) => 'hash_' + str; // Simulation

        function handleAuthAction(e, type) {
            e.preventDefault();
            
            if (type === 'login') {
                const email = document.getElementById('login-email').value;
                const pass = document.getElementById('login-pass').value;
                const user = state.users.find(u => u.email === email && u.pass === simpleHash(pass));
                if (user) {
                    state.currentUser = user;
                    state.currentView = 'home';
                } else {
                    alert('Invalid credentials');
                }
            } 
            else if (type === 'signup-player') {
                const newUser = {
                    id: 'u' + Date.now(),
                    role: 'player',
                    email: document.getElementById('sp-email').value,
                    pass: simpleHash(document.getElementById('sp-pass').value),
                    name: document.getElementById('sp-name').value,
                    dob: document.getElementById('sp-dob').value,
                    pos: document.getElementById('sp-pos').value,
                    loc: document.getElementById('sp-loc').value,
                    video: null,
                    photo: 'https://images.unsplash.com/photo-1543353071-10c8ba85a904?w=400&fit=crop'
                };
                state.users.push(newUser);
                state.currentUser = newUser;
                state.currentView = 'home';
                alert('Welcome to Team Finder!');
            }
            else if (type === 'signup-team') {
                const newUser = {
                    id: 'u' + Date.now(),
                    role: 'team',
                    email: document.getElementById('st-email').value,
                    pass: simpleHash(document.getElementById('st-pass').value),
                    name: document.getElementById('st-name').value,
                    cat: document.getElementById('st-cat').value,
                    loc: document.getElementById('st-loc').value,
                    needs: document.getElementById('st-needs').value,
                    logo: 'https://images.unsplash.com/photo-1508098682722-e99c43a406b2?w=400&fit=crop'
                };
                state.users.push(newUser);
                state.currentUser = newUser;
                state.currentView = 'home';
                alert('Club Registered Successfully!');
            }

            saveState();
            render();
        }

        function logout() {
            state.currentUser = null;
            state.currentView = 'home';
            saveState();
            render();
        }

        // --- UPLOAD LOGIC ---
        function handleImageUpload(e, role) {
            const file = e.target.files[0];
            if (!file) return;
            const url = URL.createObjectURL(file);
            if (role === 'player') state.currentUser.photo = url;
            else state.currentUser.logo = url;
            
            // Sync with users array
            const idx = state.users.findIndex(u => u.id === state.currentUser.id);
            state.users[idx] = state.currentUser;
            
            saveState();
            render();
        }

        function handleVideoUpload(e) {
            const file = e.target.files[0];
            if (!file) return;

            const statusEl = document.getElementById('upload-status');
            const fillEl = document.getElementById('upload-progress-fill');
            const percentEl = document.getElementById('upload-percent');

            statusEl.classList.remove('hidden');
            let progress = 0;
            const interval = setInterval(() => {
                progress += Math.random() * 20;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(interval);
                    setTimeout(() => {
                        state.currentUser.video = URL.createObjectURL(file);
                        const idx = state.users.findIndex(u => u.id === state.currentUser.id);
                        state.users[idx] = state.currentUser;
                        saveState();
                        statusEl.classList.add('hidden');
                        render();
                        alert('Video reel added to profile!');
                    }, 500);
                }
                fillEl.style.width = `${progress}%`;
                percentEl.innerText = `${Math.round(progress)}%`;
            }, 100);
        }

        // --- ROUTING ---
        function route(viewId) {
            state.currentView = viewId;
            saveState();
            render();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // --- RENDER ENGINE ---
        function render() {
            const root = document.getElementById('app-root');
            root.innerHTML = '';

            // Update Nav
            const authNav = document.getElementById('auth-nav-items');
            if (state.currentUser) {
                const dashRoute = state.currentUser.role === 'player' ? 'player-dashboard' : 'team-dashboard';
                authNav.innerHTML = `
                    <div class="flex items-center gap-4">
                        <button onclick="route('${dashRoute}')" class="text-xs font-black uppercase text-white flex items-center gap-2">
                            <i data-lucide="layout-dashboard" class="w-4 h-4 text-orange-500"></i> Dashboard
                        </button>
                        <button onclick="logout()" class="p-2 text-zinc-500 hover:text-red-500 transition-colors"><i data-lucide="log-out" class="w-5 h-5"></i></button>
                    </div>
                `;
            } else {
                authNav.innerHTML = `
                    <div class="flex gap-4">
                        <button onclick="route('login')" class="text-xs font-black uppercase text-zinc-400 hover:text-white px-4">Login</button>
                        <button onclick="route('signup-player')" class="bg-orange-600 hover:bg-orange-500 px-6 py-2.5 rounded-xl text-white text-[10px] font-black uppercase tracking-widest shadow-xl transition-all">Join Platform</button>
                    </div>
                `;
            }

            // View Handling
            const tplId = `tpl-view-${state.currentView}`;
            const tpl = document.getElementById(tplId);
            if (tpl) {
                root.innerHTML = tpl.innerHTML;

                // Page Specific Dynamic Data
                if (state.currentView === 'home') {
                    const actions = document.getElementById('hero-actions');
                    if (state.currentUser) {
                        const dashRoute = state.currentUser.role === 'player' ? 'player-dashboard' : 'team-dashboard';
                        actions.innerHTML = `<button onclick="route('${dashRoute}')" class="px-14 py-7 bg-orange-600 hover:bg-orange-500 text-white rounded-[2.5rem] font-black text-xl shadow-2xl uppercase tracking-widest active:scale-95 transition-all">Go to My Dashboard</button>`;
                    } else {
                        actions.innerHTML = `
                            <button onclick="route('signup-player')" class="px-10 py-5 bg-orange-600 hover:bg-orange-500 text-white rounded-[1.5rem] font-black uppercase tracking-widest shadow-xl transition-all">Sign Up as Player</button>
                            <button onclick="route('signup-team')" class="px-10 py-5 bg-zinc-900 border border-zinc-800 text-white rounded-[1.5rem] font-black uppercase tracking-widest shadow-xl transition-all">Sign Up as Club</button>
                        `;
                    }
                } 
                else if (state.currentView === 'player-dashboard') {
                    const u = state.currentUser;
                    document.getElementById('dash-player-name').innerText = u.name;
                    document.getElementById('dash-player-photo').src = u.photo;
                    document.getElementById('dash-player-meta').innerText = `${u.pos} | ${u.loc}`;
                    
                    const reelsGrid = document.getElementById('reels-grid');
                    if (u.video) {
                        reelsGrid.innerHTML = `
                            <div class="bg-zinc-950 rounded-[2rem] overflow-hidden border border-zinc-800 group relative aspect-video shadow-2xl">
                                <video src="${u.video}" class="w-full h-full object-cover" controls></video>
                                <button onclick="state.currentUser.video=null; saveState(); render();" class="absolute top-4 right-4 bg-red-600 text-white p-3 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                            </div>
                        `;
                    } else {
                        reelsGrid.innerHTML = `<div class="col-span-full border-2 border-dashed border-zinc-800 rounded-[2.5rem] p-16 text-center text-zinc-600 uppercase font-black text-xs tracking-widest">No match footage uploaded</div>`;
                    }

                    // Recommendations
                    const recs = state.users.filter(usr => usr.role === 'team' && (usr.needs.includes(u.pos) || usr.loc.includes(u.loc.split(',')[1]?.trim())));
                    document.getElementById('player-recs-grid').innerHTML = recs.map(t => `
                        <div class="bg-zinc-950 border border-zinc-800 p-8 rounded-[2rem] shadow-xl">
                            <div class="flex items-center gap-5 mb-6">
                                <img src="${t.logo}" class="w-14 h-14 rounded-xl object-cover" />
                                <div>
                                    <h4 class="text-white font-black uppercase text-sm">${t.name}</h4>
                                    <p class="text-zinc-500 text-[9px] font-black uppercase tracking-widest">${t.loc}</p>
                                </div>
                            </div>
                            <div class="bg-zinc-900/50 p-4 rounded-xl border border-zinc-800 mb-6">
                                <span class="text-[9px] font-black text-orange-500 uppercase tracking-widest block mb-1">Recruiting</span>
                                <span class="text-white font-bold text-xs uppercase">${t.needs}</span>
                            </div>
                            <button class="w-full py-4 bg-white text-zinc-950 rounded-xl font-black uppercase text-[10px] tracking-widest shadow-xl hover:bg-orange-500 hover:text-white transition-all">Apply to Club</button>
                        </div>
                    `).join('');
                } 
                else if (state.currentView === 'team-dashboard') {
                    const u = state.currentUser;
                    document.getElementById('dash-team-name').innerText = u.name;
                    document.getElementById('dash-team-logo').src = u.logo;
                    document.getElementById('dash-team-meta').innerText = `${u.cat} | ${u.loc}`;
                    filterDashboardPlayers();
                }
            }

            lucide.createIcons();
        }

        function filterDashboardPlayers() {
            const query = document.getElementById('player-search')?.value.toLowerCase() || '';
            const registry = document.getElementById('player-registry');
            const players = state.users.filter(u => u.role === 'player' && (u.pos.toLowerCase().includes(query) || u.name.toLowerCase().includes(query)));
            
            registry.innerHTML = players.map(p => `
                <div class="bg-zinc-900 border border-zinc-800 rounded-[2rem] overflow-hidden group shadow-2xl transition-all hover:border-blue-500/50">
                    <div class="aspect-video relative overflow-hidden">
                        <img src="${p.photo}" class="w-full h-full object-cover transition-transform group-hover:scale-110" />
                        <div class="absolute inset-0 bg-gradient-to-t from-zinc-950 via-transparent to-transparent"></div>
                        <div class="absolute bottom-4 left-6"><span class="bg-blue-600 text-white px-3 py-1 rounded-lg text-[9px] font-black uppercase tracking-widest">${p.pos}</span></div>
                    </div>
                    <div class="p-8">
                        <h4 class="text-white font-black text-xl uppercase mb-1">${p.name}</h4>
                        <p class="text-zinc-500 text-[10px] font-black uppercase tracking-widest mb-6">${p.loc}</p>
                        ${p.video ? `
                            <button onclick="alert('Launching private scouting reel session')" class="w-full py-4 bg-blue-600 text-white rounded-xl font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-2 shadow-xl"><i data-lucide="play-circle" class="w-4 h-4"></i> View Scouting Reel</button>
                        ` : `
                            <button disabled class="w-full py-4 bg-zinc-800 text-zinc-600 rounded-xl font-black uppercase text-[10px] tracking-widest flex items-center justify-center gap-2"><i data-lucide="video-off" class="w-4 h-4"></i> No Video Evidence</button>
                        `}
                    </div>
                </div>
            `).join('');
            lucide.createIcons();
        }

        // --- INIT ---
        window.addEventListener('load', () => {
            render();
        });
    </script>
</body>
</html>